{% extends 'admin/adminMain.html' %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href={% static "css/styles.css" %}>
{% endblock %}
{% block content %}
<h2 class="text-center">{{ title }}</h2>

<div class="row mx-4">
  <form action="{% url 'main:create_stage' %}" method="POST">
      {% csrf_token %}
      <input type="text" class="d-none" name="next" value="{% url 'main:create_stage_tournament' pk %}"/>
      <input type="text" class="d-none" name="noshow" value="true"/>
      <button class="btn btn-outline-warning">Crear una nueva fase</button>
  </form>
</div>

<form method="POST" action="">

  <div id="form-card" class="card-body">
    
    <!--Validación de errores-->
    {% csrf_token %} 
    {% if stage_formset.errors %}
    <div class="alert alert-danger alert-dismissible">
      <button
        type="button"
        class="close"
        data-dismiss="alert"
        aria-hidden="true"
      >
        ×
      </button>
      <h4><i class="icon fa fa-ban"></i> Ha ocurrido un error</h4>
      {% for field in stage_formset %} 
        {% for error in field.errors %}
          <li>{{ error }}</li>
        {% endfor %} 
      {% endfor %}
    </div>
    {% endif %}

    {{ stage_formset.management_form }}
    <h4>Seleccione las fases y sus jerarquías <button id="addBtn" type="button" class="btn btn-primary">Agregar campo</button></h4>
    {% for stage_form in stage_formset %}
        <div>
            {{ stage_form.id_fase }}
            {{ stage_form.jerarquia }}
        </div>
    {% endfor %}
  </div>

  <div class="card-footer col-11 ml-4 admin_footer">
    <button type="submit" class="btn btn-primary btn-flat float-right">
      <i class="fas fa-save"></i> {{ botton_title }}
    </button>
  </div>

    {% block extra_scripts %}
        <script src={% static 'js/stage_colector.js' %}></script>
    {% endblock %}
</form>
{% endblock %}
